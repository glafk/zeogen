/home/dglavinkov/ondemand/zeogen/source/main.py:285: UserWarning: 
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
  @hydra.main(config_path=str(PROJECT_ROOT / "conf"), config_name="cdivae")
/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'cdivae': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/_internal/hydra.py:119: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/1.2/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  ret = run_job(
[[36m2024-09-30 14:32:09,447[0m][[34mhydra.utils[0m][[32mINFO[0m] - Instantiating <data_utils.data_module.CrystDataModule>[0m
[[36m2024-09-30 14:32:09,465[0m][[34mhydra.utils[0m][[32mINFO[0m] - Instantiating <CDiVAE_nox.CDiVAE_nox>[0m
Instantiating triplet interaction
Instantiating TripInteraction_1
Instantiating autoscaleFit for TripInteraction_1_had_rbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for TripInteraction_1_sum_cbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for AtomUpdate_1_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating triplet interaction
Instantiating TripInteraction_2
Instantiating autoscaleFit for TripInteraction_2_had_rbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for TripInteraction_2_sum_cbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for AtomUpdate_2_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating triplet interaction
Instantiating TripInteraction_3
Instantiating autoscaleFit for TripInteraction_3_had_rbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for TripInteraction_3_sum_cbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for AtomUpdate_3_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_0_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_0_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_1_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_1_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_2_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_2_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_3_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_3_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/d_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating triplet interaction
Instantiating TripInteraction_1
Instantiating autoscaleFit for TripInteraction_1_had_rbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for TripInteraction_1_sum_cbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for AtomUpdate_1_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating triplet interaction
Instantiating TripInteraction_2
Instantiating autoscaleFit for TripInteraction_2_had_rbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for TripInteraction_2_sum_cbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for AtomUpdate_2_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating triplet interaction
Instantiating TripInteraction_3
Instantiating autoscaleFit for TripInteraction_3_had_rbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for TripInteraction_3_sum_cbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for AtomUpdate_3_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_0_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_0_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_1_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_1_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_2_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_2_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_3_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_3_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/y_encoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating gemnet model
Instantiating triplet interaction
Instantiating TripInteraction_1
Instantiating autoscaleFit for TripInteraction_1_had_rbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for TripInteraction_1_sum_cbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for AtomUpdate_1_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating triplet interaction
Instantiating TripInteraction_2
Instantiating autoscaleFit for TripInteraction_2_had_rbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for TripInteraction_2_sum_cbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for AtomUpdate_2_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating triplet interaction
Instantiating TripInteraction_3
Instantiating autoscaleFit for TripInteraction_3_had_rbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for TripInteraction_3_sum_cbf
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for AtomUpdate_3_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_0_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_0_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_1_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_1_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_2_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_2_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_3_sum
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
Instantiating autoscaleFit for OutBlock_3_had
AutomaticFit init called.
Loading maybe - from /home//dglavinkov/ondemand/zeogen//source/scaling_factors/decoder_scaling_factors_total_dataset_CDiVAE.json.
Fitting mode:  False
Fitted:  True
[[36m2024-09-30 14:32:10,717[0m][[34mhydra.utils[0m][[32mINFO[0m] - Passing scalers from datamodule to model>[0m
[[36m2024-09-30 14:32:10,718[0m][[34mhydra.utils[0m][[32mINFO[0m] - Instantiating <WandbLogger>[0m
[[36m2024-09-30 14:32:10,721[0m][[34mhydra.utils[0m][[32mINFO[0m] - W&B is now watching <{cfg.logging.wandb_watch.log}>![0m
wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: glafk. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.1
wandb: Run data is saved locally in ./wandb/run-20240930_143211-8919b78s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run test_cdivae_nox_small_zy
wandb: ⭐️ View project at https://wandb.ai/glafk/zeogen
wandb: 🚀 View run at https://wandb.ai/glafk/zeogen/runs/8919b78s
wandb: logging graph, to disable use `wandb.watch(log_graph=False)`
[[36m2024-09-30 14:32:12,137[0m][[34mhydra.utils[0m][[32mINFO[0m] - Instantiating the Trainer[0m
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[[36m2024-09-30 14:32:12,246[0m][[34mhydra.utils[0m][[32mINFO[0m] - Starting training![0m
You are using a CUDA device ('NVIDIA A100-SXM4-40GB MIG 3g.20gb') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [MIG-4c83e04e-d585-5cb5-bbbd-8fb3dadf0a5b]

   | Name               | Type              | Params
----------------------------------------------------------
0  | zd_encoder         | GemNetTEncoderExt | 2.5 M 
1  | zy_encoder         | GemNetTEncoderExt | 2.3 M 
2  | pzd                | CondPrior         | 33.4 K
3  | pzy                | CondPrior         | 2.2 K 
4  | decoder            | GemNetTDecoder    | 2.4 M 
5  | domain_predictor   | Sequential        | 105 K 
6  | hoa_mu_predictor   | Sequential        | 99.1 K
7  | hoa_std_predictor  | Sequential        | 99.1 K
8  | norm_hoa_predictor | Sequential        | 74.5 K
9  | fc_num_atoms       | Sequential        | 362 K 
10 | fc_lengths         | Sequential        | 99.6 K
11 | fc_angles          | Sequential        | 99.6 K
12 | fc_composition     | Sequential        | 370 K 
   | other params       | n/a               | 50    
----------------------------------------------------------
8.5 M     Trainable params
101       Non-trainable params
8.5 M     Total params
34.046    Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Setting up data module
Sanity Checking: |          | 0/? [00:00<?, ?it/s]/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:441: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=8` in the `DataLoader` to improve performance.
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Error executing job with overrides: []
Traceback (most recent call last):
  File "/home/dglavinkov/ondemand/zeogen/source/main.py", line 306, in <module>
    main()
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
        ^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dglavinkov/ondemand/zeogen/source/main.py", line 291, in main
    model = run_training(cfg)
            ^^^^^^^^^^^^^^^^^
  File "/home/dglavinkov/ondemand/zeogen/source/main.py", line 142, in run_training
    trainer.fit(model=model, datamodule=datamodule)
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 544, in fit
    call._call_and_handle_interrupt(
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 580, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 987, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1031, in _run_stage
    self._run_sanity_check()
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1060, in _run_sanity_check
    val_loop.run()
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/loops/utilities.py", line 182, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 309, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/pytorch_lightning/strategies/strategy.py", line 412, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/zeogen/source/CDiVAE_nox.py", line 884, in validation_step
    outputs = self(batch, teacher_forcing=False, num_atoms_forcing=num_atoms_forcing, training=False)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1561, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/zeogen/source/CDiVAE_nox.py", line 241, in forward
    pred_composition_per_crystal) = self.decode_stats(
                                    ^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/zeogen/source/CDiVAE_nox.py", line 216, in decode_stats
    composition_per_crystal = self.predict_composition(zy, gt_num_atoms)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/zeogen/source/CDiVAE_nox.py", line 431, in predict_composition
    pred_composition_per_atom = self.fc_composition(z)
                                ^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1561, in _call_impl
    result = forward_call(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home5/dglavinkov/ondemand/thesis/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (64x32 and 160x256)
[1;34mwandb[0m: 🚀 View run [33mtest_cdivae_nox_small_zy[0m at: [34mhttps://wandb.ai/glafk/zeogen/runs/8919b78s[0m

JOB STATISTICS
==============
Job ID: 8007669
Cluster: snellius
User/Group: dglavinkov/dglavinkov
State: RUNNING
Nodes: 1
Cores per node: 9
CPU Utilized: 00:00:00
CPU Efficiency: 0.00% of 00:03:36 core-walltime
Job Wall-clock time: 00:00:24
Memory Utilized: 0.00 MB (estimated maximum)
Memory Efficiency: 0.00% of 60.00 GB (60.00 GB/node)
WARNING: Efficiency statistics may be misleading for RUNNING jobs.
